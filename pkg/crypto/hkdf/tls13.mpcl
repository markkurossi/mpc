// -*- go -*-
//
// Copyright (c) 2025 Markku Rossi
//
// All rights reserved.
//

// Package hkdf implements the HMAC-based Extract-and-Expand Key Derivation
// Function (HKDF) as defined in RFC 5869.
package hkdf

import (
	"crypto/hmac"
)

// ExpandTLS13 implements the TLS 1.3 HKDF function.
func ExpandTLS13(pseudorandomKey, info []byte) []byte {

	input := make([]byte, len(info)+1)
	n := copy(input, info)
	input[n] = 1

	return hmac.SumSHA256(input, pseudorandomKey)
}
